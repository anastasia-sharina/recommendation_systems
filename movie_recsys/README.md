# Описание проекта

Данный проект реализует три микросервиса для рекомендательной системы: на классических алгоритмах машинного обучения (Machine Learning/ML), глубинного обучения (Deep Learning/DL) и для проведения AB-тестирования моделей ML и DL. Каждый сервис можно запускать изолированно через Docker.

В проекте реализованы этапы загрузки и анализа данных из базы, генерации признаков, обучения и оценки качества моделей, сохранения обученной модели и разработки API-сервисов для онлайн-рекомендаций. Каждый сервис обеспечивает получение персональных рекомендаций для пользователей на основе их признаков и истории взаимодействий.

## Итоги и результат

- Получена масштабируемая архитектура с тремя независимыми сервисами (ML, DL, AB).
- В каждом сервисе реализованы лучшие практики работы с моделями, API и безопасным подключением к БД.
- Все сервисы протестированы, готовы к деплою и использованию.
- Проект демонстрирует навыки в ML, DL, API, Docker и работе с промышленным кодом.

## Стек технологий

- **Python 3.8+** — основной язык разработки.
- **Pandas, NumPy** — обработка и анализ табличных данных.
- **scikit-learn** — классические ML алгоритмы, обработка признаков, кластеризация, метрики.
- **CatBoost** — основная ML-модель для ранжирования и рекомендаций.
- **NLTK** — лемматизация текстов для ML-пайплайна.
- **PyTorch** — глубокое обучение, построение эмбеддингов, интеграция с HuggingFace Transformers.
- **HuggingFace Transformers** — генерация эмбеддингов с помощью BERT, RoBERTa, DistilBERT.
- **tqdm** — прогресс-бар для инференса и обучения.
- **SQLAlchemy** — подключение и работа с базой данных PostgreSQL.
- **PostgreSQL** — хранение исходных, промежуточных и результатных данных.
- **FastAPI** — реализация API-сервисов для рекомендаций.
- **Pydantic** — описание схем данных и сериализация для API.
- **Docker** — контейнеризация сервисов для удобного деплоя и масштабирования.
- **Seaborn, Matplotlib** — визуализация анализа признаков и метрик.
- **category_encoders** — OneHotEncoder, TargetEncoder для обработки категориальных признаков.
- **Jupyter Notebook** — экспериментальный анализ, пайплайны обучения.
- **loguru** — логирование работы сервисов.

## Описание сервисов

- **ML сервис:** Классические ML-модели для рекомендаций, быстрый inference.
- **DL сервис:** Глубокое обучение на трансформерах, обработка текстов, кластеризация эмбеддингов.
- **AB сервис:** Проведение AB-тестирования моделей ML и DL, анализ результатов, статистика.

## Данные

- Используются табличные данные взаимодействий пользователей с постами и их текстовое содержимое.
- Данные хранятся в PostgreSQL, структура описана в соответствующих .ipynb-файлах.
- Для теста можно использовать mock-данные из тестовых скриптов.

## Метрики качества

## Метрики качества проекта

- **ROC-AUC (Receiver Operating Characteristic - Area Under Curve):**
  - Основная метрика для оценки качества ранжирования рекомендаций.
  - Используется как на этапе обучения ML-моделей (CatBoost, DecisionTree), так и DL-моделей.
  - Позволяет объективно сравнивать различные алгоритмы и подходы.

- **Hitrate:**
  - Финальная метрика для оценки качества рекомендаций в LMS и при интеграционном тестировании.
  - Показывает долю случаев, когда рекомендованный пост действительно был просмотрен или залайкан пользователем.

- **Feature Importance (Важность признаков):**
  - Анализируется для моделей CatBoost и других ML-алгоритмов.
  - Визуализация важности признаков помогает понять вклад текстовых, кластерных, временных и пользовательских фичей.

- **Precision, Recall, F1-score:**
  - Используются для дополнительной оценки моделей при бинарной классификации (лайк/не лайк).
  - Позволяют оценить баланс между полнотой и точностью рекомендаций.

- **AB-тестирование:**
  - Применяется для сравнения эффективности различных моделей или алгоритмов (ML vs DL).
  - Оценка статистически значимых различий показателей на реальных пользователях.

- **Логирование ошибок и отклонений:**
  - Системы логирования позволяют отслеживать нештатные ситуации, аномалии и качество работы сервисов в продакшене.

## Тестирование

- В проекте реализованы юнит-тесты для каждого сервиса.
- Для проверки API можно использовать FastAPI TestClient и curl (см. ниже).

## Пример использования API

```python
import requests
r = requests.get("http://localhost:8000/post/recommendations/", params={"id": 1000, "time": "2021-12-20T00:00:00", "limit": 5})
print(r.json())
```

## Установка зависимостей

```bash
pip install -r common/requirements.txt
```

## Docker запуск

### ML сервис (ml/app.py)
```bash
docker build -t ml-dl-ab --build-arg PROJECT=ml --build-arg SERVICE_FILE=app.py .
docker run --env-file common/.env -p 8000:8000 ml-dl-ab
```

### Deep Learning сервис (dl/service.py)
```bash
docker build -t ml-dl-ab --build-arg PROJECT=dl --build-arg SERVICE_FILE=service.py .
docker run --env-file common/.env -p 8001:8000 ml-dl-ab
```

### AB тестирование сервис (ab/service3.py)
```bash
docker build -t ml-dl-ab --build-arg PROJECT=ab --build-arg SERVICE_FILE=service3.py .
docker run --env-file common/.env -p 8002:8000 ml-dl-ab
```

## Контакты

Автор: Анастасия Шарина  
GitHub: [anastasia-sharina](https://github.com/anastasia-sharina)
=======
# recommendation_systems
Projects focused on recommendation systems using machine learning.
>>>>>>> 8bd8057973d745080290f65b66e19cf2d7dc7a30
